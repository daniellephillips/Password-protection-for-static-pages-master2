<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Secure PDF Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

    <style>
        body {
            background-image: url('grunge_patterns.jpg');
            background-attachment: fixed;
            color: #333;
            user-select: none; /* Prevent text selection */
        }

        .box {
            border-radius: 3px;
            background: rgba(101, 101, 101, 0.7);
            margin: auto;
            padding: 12px;
        }

        .lightbox {
            zoom: 1.5;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 10, 0.8);
            text-align: center;
            margin: auto;
        }

        div.horizontal {
            display: flex;
            justify-content: center;
            height: 100%;
        }

        div.vertical {
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 100%;
        }

        /* Prevent right-click */
        body, img, canvas {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        canvas {
            border: 1px solid #ccc;
            display: block;
            margin: auto;
        }

        /* Hide direct link access */
        #pdf-container {
            display: none;
        }
    </style>
</head>

<body oncontextmenu="return false;"> <!-- Disables right-click -->

    <div id="loginbox" class="lightbox">
        <div class="horizontal">
            <div class="vertical">
                <div class="box">
                    <input style="margin: 16px; text-align: center;" id="password" type="password" placeholder="password" />
                    <br />
                    <button id="loginbutton" type="button">Enter</button>
                    <p id="wrongPassword" style="display: none">wrong password</p>
                </div>
            </div>
        </div>
    </div>

    <div id="pdf-container">
        <canvas id="pdf-render"></canvas>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script type="text/javascript" src="https://rawcdn.githack.com/chrisveness/crypto/7067ee62f18c76dd4a9d372a00e647205460b62b/sha1.js"></script>

    <script type="text/javascript">
        "use strict";

        function loadPage(pwd) {
            var hash = Sha1.hash(pwd);
            var url = hash + "/index.html";

            $.ajax({
                url: url,
                dataType: "html",
                success: function(data) {
                    $("#loginbox").hide();
                    $("#pdf-container").show();
                    renderPDF('your-pdf-file.pdf'); // Change this to your actual PDF path
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    $("#password").attr("placeholder", "wrong password").val("");
                }
            });
        }

        $("#loginbutton").on("click", function() {
            loadPage($("#password").val());
        });

        $("#password").keypress(function(e) {
            if (e.which == 13) {
                loadPage($("#password").val());
            }
        });

        $("#password").focus();

        // Prevent Ctrl+S, Ctrl+P, and Ctrl+Shift+I
        document.addEventListener("keydown", function(event) {
            if (event.ctrlKey && (event.key === "s" || event.key === "p" || event.key === "u" || event.key === "i" || event.key === "Shift")) {
                event.preventDefault();
                alert("Saving and printing are disabled.");
            }
        });

        // PDF.js Viewer - Render the PDF
        function renderPDF(pdfUrl) {
            var loadingTask = pdfjsLib.getDocument(pdfUrl);
            loadingTask.promise.then(function(pdf) {
                return pdf.getPage(1);
            }).then(function(page) {
                var scale = 1.5;
                var viewport = page.getViewport({ scale: scale });

                var canvas = document.getElementById("pdf-render");
                var context = canvas.getContext("2d");
                canvas.height = viewport.height;
                canvas.width = viewport.width;

                var renderContext = {
                    canvasContext: context,
                    viewport: viewport
                };
                page.render(renderContext);
            });
        }
    </script>
</body>
</html>
